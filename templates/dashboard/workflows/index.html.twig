{% extends "dashboard/index.html.twig" %}
{% set workflow = project.workflow %}

{% block javascripts %}
    <script src="{{ asset('js/workflows.js') }}"></script>
{% endblock %}

{% block content %}
    {{ parent() }}

    <div class="container">
        <div class="header">
            <h2>{{ workflow.title }}</h2>
            <button type="button" class="btn btn-primary open-modal" data-url="{{ path('workflow_status_form', { key: project.key }) }}">
                + Add Status
            </button>
        </div>

        <div class="row fw-bold py-2 border-bottom text-muted">
            <div class="col-3">Status</div>
            <div class="col-2">Transitions</div>
            <div class="col-2">Tickets</div>
            <div class="col-2">Attributes</div>
            <div class="col-1 text-end">Action</div>
        </div>

        <div id="statusesList">
            {% include 'dashboard/workflows/statuses_list.html.twig' with { project: project, statuses: project.workflow.statuses } %}
        </div>
    </div>

    <div class="modal fade" id="workflowModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content" id="workflowModalContent">
                <div class="modal-body text-center p-5">
                    <div class="spinner-border text-primary" role="status"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-danger">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title">Confirm Delete</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to delete this status? This action cannot be undone.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Delete</button>
                </div>
            </div>
        </div>
    </div>
{% endblock %}